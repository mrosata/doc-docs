{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["/**\n * Created by michael on 2/18/16.\n */\n\"use strict\";\n\nvar isObject = (!!isObject && typeof isObject === \"function\" ? isObject :\n    function isObject (...obj) {\n      obj.forEach((o)=> {\n        if (!o || typeof o !== \"object\")\n          return false;\n      });\n      return true;\n    }\n);\n\nclass ResponseUtils {\n  constructor () {\n\n  }\n\n  /**\n   * Figure out if obj is result of Facebook login/logoff\n   *\n   * @param fbObj obj\n   * @return object|boolean \"connected\", \"disconnected\", false\n   */\n  static fbResp(fbObj) {\n    if (!isObject(fbObj))\n      return false;\n    if (!fbObj.status || fbObj.status === \"unknown\")\n      return false;\n    if (!fbObj.hasOwnProperty('authResponse') || typeof fbObj.authResponse !== \"object\")\n      return false;\n    let resp = {\n      type: 'fb'\n    };\n\n    resp.user_id = fbObj.authResponse.userID;\n    resp.access_token = fbObj.authResponse.accessToken;\n    resp.expires_in = fbObj.authResponse.expiresIn;\n    resp.signed_request = fbObj.authResponse.signedRequest;\n\n    return resp\n  }\n\n  static gplusResp(googleObj) {\n    if (!isObject(googleObj))\n      return false;\n    if (!googleObj.id_token || !googleObj.code || !googleObj.client_id)\n      return false;\n\n    let resp = {\n      type: 'google'\n    };\n    resp.client_id = googleObj.client_id;\n    resp.code = googleObj.code;\n    resp.id_token = googleObj.id_token;\n\n    return resp;\n  }\n\n  static error (msg=\"\", code=0) {\n    return {\n      type: \"error\",\n      msg: msg,\n      code: code\n    }\n  }\n}\nvar respUtil = new ResponseUtils();\n\n\n/**\n * After page load run Foundation and handle events\n */\njQuery(function ($) {\n  var Foundation = $(document).foundation();\n\n  // Get the State for the App set through the templating engine\n  let ddStateElem = $('[data-doc-doc-state-object]');\n  const _STATE = (ddStateElem.length ? ddStateElem.data('appState') : \"\");\n\n  /**\n   * Open Modals with Errors or Flash Message Modals on load\n   *\n   * Check if a form inside of a reveal modal was submitted with errors\n   * and if so then have it be open. If no forms have error messages then\n   * this function will also check for Flask Flash Messages and show them\n   * inside modals.\n   */\n  function openFlashMessageAndErrorModalsOnLoad () {\n    var formsWithErrors = $('.reveal[data-errors-present=\"true\"]'),\n        flaskFlashMessages = $('.flash-messages .reveal');\n    if (formsWithErrors.length) {\n      formsWithErrors.foundation(\"open\");\n    } else if (flaskFlashMessages.length) {\n      // We only pop open flash messages if there aren't any forms with errors open.\n      flaskFlashMessages.each(function(t, n, a){\n        $(this).foundation(\"open\");\n      });\n    }\n  }\n  openFlashMessageAndErrorModalsOnLoad();\n\n  /**\n   * Log User out of the app (including fb or any other oauth).\n   */\n  window.accountDocDocsLogoff = function() {\n    FB.logout();\n    window.location = \"/logout\";\n  };\n\n  window.facebookDocDocsLogin = function() {\n\n    FB.login(function(fbObject) {\n\n      let fbUserInfo = ResponseUtils.fbResp(fbObject);\n      if (!fbUserInfo || !isObject(fbUserInfo))\n        return false;\n\n      // Put the state of app from page into our response.\n      fbUserInfo._state = _STATE;\n\n      $.ajax({\n        url: \"/api/login\",\n        type: \"post\",\n        data: JSON.stringify(fbUserInfo),\n        contentType: \"application/json\",\n        success(result) {\n          // handle response from our own app\n          if (isObject(result) && result.status.toLowerCase() === \"success\") {\n            window.location = result.data.location;\n          }\n          else {\n            // The login failed somehow on server side\n            alert(\"Hew Son, Ve Ack a Pro Blah!\");\n          }\n        },\n        error(err) {\n          console.error(err);\n        }\n      });\n    }, {scope: 'email,public_profile,user_friends'});\n\n  };\n\n\n  window.googleDocDocsLogin = function(authResult) {\n    console.debug(authResult);\n    authResult = ResponseUtils.gplusResp(authResult);\n    if (!authResult['code'])\n      return false;\n\n    authResult._state = _STATE;\n    // Hide the sign in button\n    document.querySelector('.google-login-button').style.display = 'none';\n\n    $.ajax({\n      type: \"post\",\n      url: \"/api/login\",\n      dataType: \"json\",\n      contentType: \"application/json\",\n      data: JSON.stringify(authResult),\n      success(result) {\n        // handle response from our own app\n        if (isObject(result) && result.status.toLowerCase() === \"success\") {\n          window.location = result.data.location;\n        }\n        else {\n          // The login failed somehow on server side\n          alert(\"Hew Son, Ve Ack a Pro Blah!\");\n        }\n      }\n    });\n\n  };\n\n});\n"],"sourceRoot":"/source/"}